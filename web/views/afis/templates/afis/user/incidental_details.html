<!DOCTYPE html>
<html lang="en">
    <head>
        <title>ICNML</title>
        <meta name="description" content="International Close Non-Matches Library">
        
        {% autoescape false %}
            {{ app_files }}
        {% endautoescape %}
        
        <script type="text/javascript">
            baseurl = "{{ baseurl }}";
        </script>
        
        <style type="text/css">
            :root {
                --imgsize: 200px;
            }
            .icnml_download_incidental_mark {
                width: fit-content;
                width: -moz-fit-content;
                margin-top: 30px;
                margin-bottom: 30px;
                margin-left: auto;
                margin-right: auto;
            }
        </style>
    </head>
    <body class="icnml_main_layout">
        {% include "header.html" %}
        {% include navigation %}
        
        <div class="icnml_content">
            <div class="icnml_download_incidental_mark">
                <a class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only icnml_button_square"
                    href="{{ url_for( 'afis.download_mark', uuid = uuid ) }}"
                    id="download_mark"
                    role="button"
                    aria-disabled="false" >
                    <span class="ui-button-text">Download mark</span>
                </a>
            </div>
            
            <div class="icnml_list_of_boxes">
                
                {% for cnm in cnm_list %}
                    <div id="candidate_{{ cnm[ 'uuid' ] }}_outer">
                        <div class="ui-widget-header ui-corner-top icnml_box_top" id="candidate_{{ cnm[ 'uuid' ] }}_filename">{{ cnm[ 'uuid' ][ 0:18 ] }}</div>
                        <div class="ui-widget-content ui-corner-bottom icnml_box_content">
                            <div
                                id="candidate_{{ cnm[ 'uuid' ] }}"
                                class="icnml_pointer"
                                style="background-image: url( {{ url_for( 'afis.image_auto_detect_format', cnm_uuid = cnm[ 'uuid' ], file_uuid = cnm[ 'file_uuid' ] or 'None', fpc = 0 ) }} )">
                            </div>
                        </div>
                    </div>
                {% endfor %}
                
                <div>
                    <div class="ui-widget-header ui-corner-top icnml_box_top">New CNM candidate</div>
                    <div class="ui-widget-content ui-corner-bottom icnml_box_content">
                        <div class="icnml_button icnml_new_button icnml_pointer" id="icnml_new_cnm_button">
                            <span>+</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            
        <script type="text/javascript">
            {% for cnm in cnm_list %}
                $( "#candidate_{{ cnm[ 'uuid' ] }}_outer" ).on( "click", function(){
                    window.location = "{{ url_for( 'afis.cnm_edit', target_uuid = uuid, cnm_uuid = cnm[ 'uuid' ] ) }}";
                } );
            {% endfor %}
        
            $( "#icnml_new_cnm_button" ).on( "click", function()
            {
                window.location = "{{ url_for( 'afis.new_cnm_case', uuid = uuid, target_type = 'incidental' ) }}";
            } );
            
            $( "#icnml_navigation_afis_incidental" )
                .addClass( "activated" );
            
            $( "#navloc" ).append(
                $( "<a />" )
                    .attr( "href", "{{ url_for( 'afis.list_donors_incidental' ) }}" )
                    .text( "Incidental list" )
            )
            .append(
                $( "<span />" ).text( ">" )
            )
            .append(
                $( "<span />" ).text( "{{ uuid[ 0:18 ] }}" )
            )
        </script>
    </body>
</html>

